[tox]
envlist = format, lint, typecheck, test

[gh-actions]
python =
    3.12: py312

[testenv]
deps = -r{toxinidir}/requirements.txt
setenv =
    PYTHONPATH = {toxinidir}

[testenv:format]
deps = black
       isort
commands =
    black --check --diff services/
    isort --check-only --diff services/

[testenv:lint]
deps = ruff
commands =
    ruff check services/

[testenv:typecheck]
deps = mypy
       types-requests
       types-pytz
commands =
    mypy services/


[testenv:test]
deps = pytest
       -r{toxinidir}/requirements.txt
commands =
    pytest services/


[testenv:cov]
deps = pytest
       pytest-cov
       -r{toxinidir}/requirements.txt
commands =
    pytest services/ --cov=services --cov-report=xml --cov-report=term-missing

[testenv:py312]
deps = {[testenv:test]deps}
commands = {[testenv:test]commands}
